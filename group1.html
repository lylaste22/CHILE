<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <!-- <link rel="shortcut icon" href="../../docs-assets/ico/favicon.png"> -->

    <title>CHILE 2015</title>

    <!-- Bootstrap core CSS -->
    <link href="//netdna.bootstrapcdn.com/bootswatch/3.0.2/yeti/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="http://getbootstrap.com/examples/jumbotron-narrow/jumbotron-narrow.css" rel="stylesheet">

    <!-- Just for debugging purposes. Don't actually copy this line! -->
    <!--[if lt IE 9]><script src="../../docs-assets/js/ie8-responsive-file-warning.js"></script><![endif]-->

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
    
        <script type="text/javascript" src="http://latex.codecogs.com/latexit.js"></script>
  </head>

  <body>

    <div class="container">
      <div class="header">
        <ul class="nav nav-pills pull-right">
          <li><a href="index.html">Home</a></li>
          <li class="active"><a href="group1.html">Group 1</a></li>
          <li><a href="group2.html">Group 2</a></li>
          <li><a href="group3.html">Group 3</a></li>
          <li><a href="https://github.com/lylaste22/CHILE" target="_blank">Code</a></li>
        </ul>
        <h3 class="text-muted">CHILE 2015</h3>
      </div>

      <div class="container">
        <h1 style="text-align:center">Chile-Harvard Innovative Learning Exchange 2015</h1>
      </div>
	<div class="jumbotron">
          <iframe src="//player.vimeo.com/video/85659466?color=ffffff" width="520" height="293" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>
      </div>


      <div class="row marketing">
        <div class="col-md-12">

        <h3> Source detection and source identification </h3>

	<p> Given the collection of images obtained from DECam, the first task is the detection of astronomical objects. Each image is taken by pointing the telescope at a specific part of the sky and the result is a pixelized 2D record of the brightness of that region. The pixel intensity in the image is due to the light coming from sources, background light, noise of the sensor or cosmic rays. Given the differences in intensity of each pixel of the image and the signature of groups of pixels, celestial objects can be identified and later classified as a star, a galaxy, an asteroid or a planet. The goal for this part of the project is to detect these sources as objects and characterize them taking into account the removal of cosmic rays. Characterization involves determining source brightness, source position on the sky and source shape as stars and distant galaxies appear as point sources. The data set contains images of the same part of the sky multiple times constituting multiple epoch records of the same object. </p>

	<p> Additionally, since the same part of the sky may have been already observed and recorded by various existing surveys, a cross-references with these known sources was completed to extract additional known information for each object identified.</p>
	
	<p> This part of the work-flow produces as output a catalog containing a list of all identified objects with all the extracted features.  </p>
	

	<h3> Data </h3>
	<ul>
		<li> Forty fields observed during four nights </li>
		<li> Every image covers 3 sq. deg. </li>
		<li> four times per nights (160 or 180 sec per exposure). </li>
		<li> g filter was used. </li>
		<li>61458 output files corresponding to 20486 processed images </li>
	</ul>
	
        <h3> Aim </h3>
        <p>Develop a pipeline in the cluster to process the 20K fitz images completing the following tasks:</p>
	<ol>
		<li> Collect all the available raw CCD images available in fitz format </li>
		<li> Obtain image meta data from the fitz header </li>
		<li> Remove cosmic rays using specific image read-noise and gain per CCD </li>
		<li> Identify astronomical objects in each image using parameters from meta-data extracted </li>
		<li> Generate a catalog with a list of all identified objects per image and additional information to be later used in the classification work </li>
		<li> Cross reference with Virtual Observatory to pull additional information for known objects </li>

	</ol>

	<h3> Procedure </h3>
	<h4> Cosmic ray rejection  </h2>

	<p>Cosmic rays are high energy charged particles, originating in outer space, that travel at nearly the speed of light and strike the Earth from all directions. Cosmic rays have a unique signature and should be removed from the catalog. Cosmic rays have hard edges, unlike stars or galaxies. This is because they are produced by individual particles that hit the detector and not by collections of photons that propagate through the atmosphere and the telescope optical system. </p> 
	
	<p>Conventional approaches to detect and eliminate cosmic rays from images rely on the difference in contrast between the cosmic ray and its surrounding environment. These types of algorithms may generate inaccurate results when the PSF Point Spread Function is smaller than the cosmic ray. A more reliable approach for discriminating between low resolution point sources and cosmic-rays was developed by Pieter van Dokkum based on a variation of Laplacian edge detection. This method is widely used for highlighting boundaries in digital images.  The algorithm identifies cosmic-rays of arbitrary shapes and sizes by the sharpness of their edges. The results are therefore, largely independent of the morphology of cosmic-rays. </p>
	
	<p>The python module Cosmics.py is used to detect and clean up cosmic ray hits on images based on Pieter van Dokkum's Laplacian algorithm. The module can handle images in FITS format. The process is iterative and typically requires 4 iterations for the optimal removal of cosmic rays from DECam observations. The module is robust and requires tuning on several user-defined parameters which are obtained from the image meta-data. The following non-default parameter values obtained from the FITS header work well with the collected DECam observations:</p>
	
	<pre><code>gain=4.5 (gain [electrons ADU−1 ] )
readn=7.0 (read noise [electrons] )
sigfrac=0.3 (fractional detection limit for neighboring pixels)
objlim=1 (contrast limit between cosmic rays and an underlying object) 
	</code>
	</pre>
	
	<p></p>
	<p>The image below shows an illustration of the original image including cosmic rays and their subsequent rejection using the cosmics.py module:</p>
	
	<center>
        	<img class="" src="images/pygif.gif" style="width:device-width;max-width:100%;margin:auto;display:inline"/>
        </center>
	
	<p></p>
	<p>Although the cosmics.py module accomplishes the cosmic ray defect removal very well for a single image, it does not work well for the 20K images available for processing due to time performance. CRBLASTER is an alternative implementation of the L.A.COSMIC algorithm written in the C language that employs an embarrassingly-parallel algorithm using the high-performance computing industry standard Message Passing Interface (MPI) library. As such, it is ideally suited to being implemented in a parallel-processing image-analysis application. </p>
	
	<p>The original package for CRBLASTER has hard-coded parameters including noise and gain. To obtain better results, we want to use specific parameter values obtained from the image meta-data. To achieve this, we patched the CRBLASTER application to accept parameters. The results for this customized version of the cosmic ray removal application obtained are equally effective as the python cosmics module as seen in the animation below:</p>
	
	<center>
        	<img class="" src="images/crgif.gif" style="width:device-width;max-width:100%;margin:auto;display:inline"/>
        </center>
	
	
	
	
	
  
	<h4> Object Identification  </h2>
	
	<h4> Light Curve Extraction  </h2>
	
	<h4> Cross-Reference with Virtual Catalogs  </h2>

	<ol>
		<li> Detect pixels with high values and measure the background level and noise: </li>

		<p> For each CCD, we first identify the pixels with large ADU values using 99.6% quantile This gives a binary image of 'bright pixels', which are possible sources, and 'faint pixels', which we use to estimate background.</p>

		<li> Identify blocks: </li>
	
		<p> We single out possible sources by finding the smallest blocks containing connected 'bright pixels'. </p>
	
		<li> Cosmic rays test: </li>
	
		<p> For each small block, we calculate the skewness and kurtosis of the observed ADUs to rule out cosmic rays.</p>

		<li> Gaussian fit: position, shape, pixel coordinates: </li>
		
		<p> We fit a Gaussian model to construct a catalogue containing positions <span lang="latex"> (\mu_{x}, \ \mu_{y}) </span>, flux <span lang="latex"> A </span>, spread <span lang="latex"> (\sigma_{x}, \ \sigma_{y}) </span> , inclination <span lang="latex"> \rho </span> and errors of the the sources for each CCD, field and epoch.</p>
		
		<center>
		<div lang="latex">
		I_{x,y}= \frac{A}{2 \pi \sigma_{x} \sigma_{y}\sqrt{1-\rho^{2}}}exp(-\frac{1}{1-\rho^{2}}[\frac{(x-\mu_{x})^{2}}{2\sigma_{x}^{2}}+\frac{(y-\mu_{y})^{2}}{2\sigma_{y}^{2}}-\frac{\rho (x-\mu_{x})(y-\mu_{y})}{\sigma_{x} \sigma_{y}}])
		</div>
		</center>


		<p> In the following image is presented a 1D cut of the CCD centered on a star and the corresponding gaussian fit.</p> 
		<center>
        	  <img class="" src="img/1dgauss.png" width="120%" height="120%" />
		</center>
        	<p> A heat map comparing the raw image and the model image after the gaussian fit is presented below.</p>
       		<center>
        	  <img class="" src="img/2dgauss.png" width="130%" height="130%" />
		</center>

		<p> An example of just a fraction of a CCD image with stars and cosmic rays. </p>
		<center>
        	  <img class="" src="img/rawdata.png" width="80%" height="80%" />
		</center>
		<p> And its corresponding model image after we found the sources and performed the fit.</p>
		<center>
	          <img class="" src="img/modelimage.png" width="100%" height="100%" />
	        </center>


		<li> Transform to celestial world coordinates: </li>
	
		<p> Using the header information of each fits file, we transform the position of the sources and its errors to world celestial coordinates (Right Ascension  and Declination). An example of a arbitrary region of one of the 40 fields is presented below. </p>
 
 		<center>
	          <img class="" src="img/stars.png" width="100%" height="100%" />
	        </center>
	        
		<li> Calibration with Standard stars from the Sloan Digital Sky Survey (SDSS): </li>
	
		<p> The previous steps were done also for observations pointing to standard fields. One of them was a field covered by the Sloan Digital Sky Survey, and it was used for transform from ADU to magnitudes in the U band. </p>
 
		<li>  Matching between epochs: </li>
	
		<p> Finally we took the 16 corresponding catalogues for each CCD and field. Using the position in celestial coordinates and its errors in each epoch, we performed a matching of the objects through the different epochs. After this we had 16 catalogues for the same region of the sky, with a ID for each object and its magnitudes at different epochs, i.e. we obtaied light curves for the different objects found in the 40 fields. </p>
	</ol>


	<h3> Future work </h3>
	<ul>
	<li> Improve the cosmic ray detection. </li>
	<li> Add gaussian mixture in order to detext sources that could be very close. </li>
	<li> Use a more realistic profile for the Point Spread Function (PSF) </li>
	<li> Use others standard fields. </li>
	<li> Improve the distance function using additional measurement like the flux (or something similar) in the object-matching process. </li>
	</ul>

        </div>  
	</div>    
	<div class="footer">
        <p><b>Group 1:</b> Lyla Fadden, Ismael Alvarez, Minjae Kim, Diego Farías</p>
      </div>

    </div> <!-- /container -->


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://code.jquery.com/jquery.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.0.2/js/bootstrap.min.js"></script>
  </body>
</html>
